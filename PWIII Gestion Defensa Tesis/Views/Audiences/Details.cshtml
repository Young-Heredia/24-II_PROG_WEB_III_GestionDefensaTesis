@model PWIII_Gestion_Defensa_Tesis.Models.Audience

@{
    ViewData["Title"] = "Details";
}

<div class="container mt-4">
    <h1 class="text-center mb-4">Details</h1>
    <h3 class="text-center mb-4">View Details of Audience</h3>

    <div class="row">
        <div class="col-md-8 col-sm-12">
            <h4>Audience Information</h4>
            <hr />
            <dl class="row">

                <dt class="col-sm-4"><strong>@Html.DisplayNameFor(model => model.Name)</strong></dt>
                <dd class="col-sm-8">@Html.DisplayFor(model => model.Name)</dd>

                <dt class="col-sm-4"><strong>@Html.DisplayNameFor(model => model.Direction)</strong></dt>
                <dd class="col-sm-8">@Html.DisplayFor(model => model.Direction)</dd>

                <dt class="col-sm-4"><strong>@Html.DisplayNameFor(model => model.Latitude)</strong></dt>
                <dd class="col-sm-8">@Html.DisplayFor(model => model.Latitude)</dd>

                <dt class="col-sm-4"><strong>@Html.DisplayNameFor(model => model.Longitude)</strong></dt>
                <dd class="col-sm-8">@Html.DisplayFor(model => model.Longitude)</dd>
            </dl>

        </div>

        <div class="col-md-4 col-sm-12 mb-3">
            @if (!string.IsNullOrEmpty(Model.ImagePath))
            {
                <div class="text-center">
                    <img src="@Model.ImagePath" alt="Audience Image" class="img-fluid rounded border shadow-sm" style="max-height: 300px; object-fit: cover;" />
                </div>
            }
            else
            {
                <div class="text-center">
                    <p>No image available</p>
                </div>
            }
        </div>
    </div>

    <div class="col-lg-12 mt-4">
        <div id="mapContainer" style="height: 300px;"></div>
    </div>

    <div class="form-group d-flex gap-3 mt-3">
        <a asp-action="Edit" asp-route-id="@Model?.Id" class="btn btn-primary btn-lg">Edit</a>
        <a asp-action="Index" class="btn btn-secondary btn-lg">Back to List</a>
    </div>
</div>

@section Scripts {
    <script type="text/javascript" src="https://www.bing.com/api/maps/mapcontrol?callback=loadMapEdit" async defer></script>
    <script>
        function loadMapEdit() {
            const latitude = parseFloat('@Model.Latitude'.replace(',', '.'));
            const longitude = parseFloat('@Model.Longitude'.replace(',', '.'));

            const map = new Microsoft.Maps.Map('#mapContainer', {
                credentials: 'AgqOaEk-a82xj49nR5TlSVCRSO_tOw0yV3PSCnfUiD533uSOhRpQO5HaqzoYAmlh',
                center: new Microsoft.Maps.Location(latitude, longitude),
                zoom: 14
            });

            const pin = new Microsoft.Maps.Pushpin(map.getCenter(), {
                title: '@Model.Name', 
                subTitle: '@Model.Direction', 
                text: '@Model.Name'[0] 
            });

            map.entities.push(pin);
        }
    </script>
}